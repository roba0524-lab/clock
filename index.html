<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ç½®æ™‚è¨ˆï¼‹å¤©æ°—</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root {
  --bg: rgb(51,123,204);
  --text: #ffffff;
}

body {
  margin: 0;
  background: var(--bg);
  color: var(--text);
  font-family:
    "Hiragino Kaku Gothic ProN",
    "Noto Sans JP",
    -apple-system,
    BlinkMacSystemFont,
    "Segoe UI",
    sans-serif;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: hidden;
  transition: background 1s ease;
}

.container {
  width: 100%;
  text-align: center;
  animation: burninShift 180s infinite alternate ease-in-out;
}

/* ğŸ”¥ ç„¼ãä»˜ãé˜²æ­¢ */
@keyframes burninShift {
  from { transform: translate(0, 0); }
  to   { transform: translate(12px, 8px); }
}

/* â° æ™‚åˆ» */
.time {
  font-size: 27vw;
  font-weight: 900;
  line-height: 1;
  letter-spacing: -0.03em;
}

/* ğŸ“… æ—¥ä»˜ */
.date {
  font-size: 4vw;
  margin-top: 1vh;
  opacity: 0.9;
}

/* ğŸŒ¤ å¤©æ°— */
.weather {
  margin-top: 4vh;
}

.weather-main {
  font-size: 5vw;
  font-weight: 600;
}

.weather-rain {
  margin-top: 1vh;
  font-size: 4.5vw;
  font-weight: 600;
}
</style>
</head>

<body>
<div class="container">
  <div class="time" id="time">--:--</div>
  <div class="date" id="date">----</div>

  <div class="weather">
    <div class="weather-main" id="weatherMain">
      â˜€ï¸ æœ€é«˜ --â„ƒ / æœ€ä½ --â„ƒ / ç¾åœ¨ --â„ƒ
    </div>
    <div class="weather-rain" id="weatherRain">
      â˜‚ï¸ --%
    </div>
  </div>
</div>

<script>
// =====================
// â° æ™‚è¨ˆ
// =====================
function updateTime() {
  const now = new Date();

  time.textContent =
    now.getHours().toString().padStart(2, "0") + ":" +
    now.getMinutes().toString().padStart(2, "0");

  date.textContent = now.toLocaleDateString("ja-JP", {
    month: "long",
    day: "numeric",
    weekday: "short"
  });
}
setInterval(updateTime, 1000);
updateTime();

// =====================
// ğŸ¨ èƒŒæ™¯è‰²åˆ¶å¾¡
// =====================
function setBackground(weatherType) {
  const hour = new Date().getHours();

  // ğŸŒ™ å¤œãŒæœ€å„ªå…ˆ
  if (hour >= 18) {
    document.documentElement.style.setProperty("--bg", "#0b1d3a");
    return;
  }

  switch (weatherType) {
    case "sunny":
      document.documentElement.style.setProperty("--bg", "#f4a340");
      break;
    case "mixed":
      document.documentElement.style.setProperty("--bg", "rgb(51,123,204)");
      break;
    case "rain":
      document.documentElement.style.setProperty("--bg", "#8a8a8a");
      break;
    default:
      document.documentElement.style.setProperty("--bg", "rgb(51,123,204)");
  }
}

// =====================
// ğŸŒ¤ å¤©æ°—ï¼ˆOpen-Meteoï¼‰
// =====================
async function fetchWeather() {
  const url =
    "https://api.open-meteo.com/v1/forecast" +
    "?latitude=34.612&longitude=135.734" +
    "&daily=temperature_2m_max,temperature_2m_min,precipitation_probability_max,weather_code" +
    "&current_weather=true" +
    "&timezone=Asia%2FTokyo";

  const res = await fetch(url);
  const data = await res.json();

  const maxTemp = Math.round(data.daily.temperature_2m_max[0]);
  const minTemp = Math.round(data.daily.temperature_2m_min[0]);
  const rain = data.daily.precipitation_probability_max?.[0];
  const currentTemp = Math.round(data.current_weather.temperature);
  const code = data.daily.weather_code[0];

  let icon = "â˜€ï¸";
  let weatherType = "sunny";

  // ğŸŒ§ é™æ°´ç¢ºç‡50%ä»¥ä¸Šã¯é›¨æ‰±ã„
  if (rain !== undefined && rain >= 50) {
    icon = "ğŸŒ§ï¸";
    weatherType = "rain";
  }
  else if (code >= 51) {
    icon = "ğŸŒ§ï¸";
    weatherType = "rain";
  }
  else if (code >= 1 && code <= 3) {
    icon = "â›…";
    weatherType = "mixed";
  }
  else if (code >= 45 && code <= 48) {
    icon = "â˜ï¸";
    weatherType = "mixed";
  }

  weatherMain.textContent =
    `${icon} æœ€é«˜ ${maxTemp}â„ƒ / æœ€ä½ ${minTemp}â„ƒ / ç¾åœ¨ ${currentTemp}â„ƒ`;

  weatherRain.textContent =
    rain !== undefined ? `â˜‚ï¸ ${rain}%` : "â˜‚ï¸ æœªå–å¾—";

  setBackground(weatherType);
}

fetchWeather();
setInterval(fetchWeather, 30 * 60 * 1000);
</script>
</body>
</html>
